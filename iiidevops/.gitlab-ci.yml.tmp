stages:
  - initial
  - scan
  - build
  - deploy
  - test

include:
  - project: 'iiidevops-templates/ci-template'
    ref: 'v2.1.5'
    file: 'ci/template.gitlab-ci.yml'
  - project: 'iiidevops-templates/ci-template'
    ref: 'v2.1.5'
    file: 'job/DeployDatabase-MS.gitlab-ci.yml'

Deploy--Database (MS-SQL):
  variables:
    iiidevops: deployed-environments
    CHART_DB_GUI: "true"
    CHART_DB_PASSWORD: "DevOps_123"
    CHART_DB_TAG: "2019-CU10-ubuntu-20.04"
    CHART_NFS_ENABLED: "false"
    CHART_NFS_SERVER_IP: "10.20.0.100"
    CHART_VERSION: "0.2.0"
  only:
    - master

Deploy--Wait DB deployment:
  variables:
    iiidevops: deployed-environments
    max_wait: 128
  only:
    - master
